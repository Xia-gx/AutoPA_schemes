,pp,ap,mp,kp
0,A,send,ID_A,Pub_S
1,A,send,ID_B,Pub_S
2,A,send,E_(Password_A)ID_A,Pub_S
3,B,receive,ID_A,Pub_S
4,B,receive,ID_B,Pub_S
5,B,receive,E_(Password_A)ID_A,Pub_S
6,B,encrypt,ID_A,Pub_S
7,B,encrypt,ID_B,Pub_S
8,B,encrypt,E_(Password_A)ID_A,Pub_S
9,B,encrypt,ID_B,Pub_S
10,B,encrypt,ID_A,Pub_S
11,B,encrypt,E_(Password_B)ID_B,Pub_S
12,B,send,ID_A,Pub_S
13,B,send,ID_B,Pub_S
14,B,send,E_(Password_A)ID_A,Pub_S
15,B,send,ID_B,Pub_S
16,B,send,ID_A,Pub_S
17,B,send,E_(Password_B)ID_B,Pub_S
18,S,receive,ID_A,Pub_S
19,S,receive,ID_B,Pub_S
20,S,receive,E_(Password_A)ID_A,Pub_S
21,S,receive,ID_B,Pub_S
22,S,receive,ID_A,Pub_S
23,S,receive,E_(Password_B)ID_B,Pub_S
24,S,decrypt,ID_A,Pri_S
25,S,decrypt,ID_B,Pri_S
26,S,decrypt,E_(Password_A)ID_A,Pri_S
27,S,decrypt,ID_B,Pri_S
28,S,decrypt,ID_A,Pri_S
29,S,decrypt,E_(Password_B)ID_B,Pri_S
30,S,send,E_(Password_A)K_AB,
31,S,send,E_(Password_B)K_AB,
32,B,receive,E_(Password_A)K_AB,
33,B,receive,E_(Password_B)K_AB,
34,B,encrypt,hashK_AB,K_AB
35,B,encrypt,ID_B,K_AB
36,B,send,E_(Password_A)K_AB,
37,B,send,hashK_AB,K_AB
38,B,send,ID_B,K_AB
39,A,receive,E_(Password_A)K_AB,
40,A,receive,hashK_AB,K_AB
41,A,receive,ID_B,K_AB
42,A,decrypt,hashK_AB,K_AB
43,A,decrypt,ID_B,K_AB
44,A,send,E_(K_AB)hashID_B,
45,B,receive,E_(K_AB)hashID_B,
